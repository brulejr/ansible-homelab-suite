---
# Public-safe defaults only.
# Anything environment specific (domain_name, IPs, tokens) must live in the private inventory repo.

ansible_user: sysadm

timezone: America/New_York

username: "sysadm"
groupname: "sysadm"

puid: "1000"
pgid: "1000"

homelab_name: "example.homelab"
domain_name: "example.invalid"

# Docker directories
docker_dir: /opt/homelab/apps
data_dir: /opt/homelab/data

# Docker network
docker_network: "homelab"

# Traefik file provider defaults (inventory can override)
traefik_dynamic_dir: "{{docker_dir}}/traefik/dynamic"
traefik_dynamic_mount: "/etc/traefik/dynamic"

# Edge gateway binding:
# Inventory should set traefik_bind_ip = edge_vip_ip (e.g., 10.10.60.30)
traefik_bind_ip: "0.0.0.0"

# Edge SSO middleware name referenced from file provider
sso_middleware_name: "homelab-sso-users@file"

# When app roles publish ports, bind them to this IP if provided by host_vars
# (inventory should set server_bind_ip per host to the server VLAN IP)
server_bind_ip: "0.0.0.0"

# ==========================
# keycloak (Identity server)
# ==========================
keycloak_fqdn: "keycloak.{{ domain_name }}"
keycloak_realm: "{{ homelab_name }}"

# ==========================
# oauth2-proxy (SSO gateway)
# ==========================
sso_gateway_fqdn: "sso.{{ domain_name }}"
sso_gateway_internal_base_url: "http://sso-gateway:4180"

# Client registered in Keycloak
sso_oidc_client_id: "homelab-sso"
sso_oidc_client_secret: "{{ vault_sso_oidc_client_secret }}"

# Cookie secret: 32-byte base64 (oauth2-proxy expects base64 secret)
sso_cookie_secret: "{{ vault_sso_cookie_secret }}"

# SSO cookie domain so login works across entire domain
sso_cookie_domain: ".{{ domain_name }}"

# If you want to restrict who can log in:
# Use "*" to allow any Keycloak user. Or set to your domain (if you enforce email domain).
sso_email_domains:
  - "*"

# Optional: Keycloak groups/roles requirement (leave empty for no restriction)
sso_allowed_groups: []
